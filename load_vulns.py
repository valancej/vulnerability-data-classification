#!/usr/bin/python3
import json

with open('test.json') as f:
  data = json.load(f)

advisories = []

ghsa_record = {}

## query_data is the 100 records fetched from GitHub GraphQL API
## ghsa is a single ghsa record in a query_data response

for query_data in data:
    for ghsa in query_data:
        ghsa_record["ghsaId"] = ghsa.get("ghsaId")
        #ghsa_record["summary"] = ghsa.get("summary")
        ghsa_record["description"] = ghsa.get("description")
        ghsa_package_ecosystem = ghsa.get("vulnerabilities").get("nodes")[0].get("package").get("ecosystem")
        ghsa_record["package_ecosystem"] = ghsa_package_ecosystem
        advisories.append(ghsa_record.copy())

cleaned_json = json.dumps(advisories)
print(cleaned_json)
